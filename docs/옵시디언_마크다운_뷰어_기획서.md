# 옵시디언 마크다운 뷰어 웹앱 기획서

> 작성일: 2026-02-27
> 버전: v1.0

---

## 1. 프로젝트 개요

로컬 컴퓨터에 저장된 옵시디언(Obsidian) 볼트(Vault) 폴더를 웹 브라우저에서 탐색하고, 마크다운 파일을 렌더링하여 볼 수 있는 로컬 웹 뷰어 애플리케이션이다.
Claude CLI 또는 Codex CLI를 연동하여 선택한 마크다운 파일을 AI가 요약·정리하고, 결과물을 지정 폴더에 자동으로 저장하는 기능을 포함한다.

- **실행 주소**: `http://localhost:8101`
- **언어/프레임워크**: Python (FastAPI) + Vanilla JS (HTML/CSS)
- **AI 연동**: Claude CLI (`claude -p`), Codex CLI (`codex exec`)

---

## 2. 화면 레이아웃

```
┌─────────────────────────────────────────────────────────────────┐
│  헤더: [앱 타이틀] [볼트 경로] [설정⚙] [Git Pull↓] [Git Push↑]  │
├──────────────┬──────────────────────────────────────────────────┤
│              │                                                  │
│  폴더 트리   │           마크다운 뷰어                           │
│  (좌측 패널) │           (우측 상단 60%)                         │
│              │                                                  │
│  📁 폴더명   │  # 파일 제목                                      │
│  ├ 📄 파일   │  내용 렌더링...                                    │
│  └ 📁 하위   │                                                  │
│    └ 📄 파일 ├──────────────────────────────────────────────────┤
│              │           AI 패널 (우측 하단 40%)                  │
│              │  [Claude ●] [Codex ○]  [issue 폴더에 저장]        │
│              │  ┌──────────────────────────────────────────┐   │
│              │  │ 프롬프트 입력 (수정 가능)                  │   │
│              │  └──────────────────────────────────────────┘   │
│              │  [▶ 실행]                    [결과 영역]          │
└──────────────┴──────────────────────────────────────────────────┘
```

---

## 3. 기능 상세

### 3.1 폴더 트리 (좌측 패널)

| 항목 | 내용 |
|------|------|
| 표시 대상 | `.md` 파일, 폴더 (숨김 파일 제외) |
| 초기 볼트 경로 | 환경변수 `OBSIDIAN_VAULT_PATH` 또는 앱 내 설정 |
| 인터랙션 | 폴더 클릭 → 접기/펼치기, 파일 클릭 → 우측 뷰어에 렌더링 |
| 현재 파일 표시 | 선택된 파일 하이라이트 |
| 새로고침 | 트리 상단 새로고침 버튼 |

### 3.2 마크다운 뷰어 (우측 상단)

| 항목 | 내용 |
|------|------|
| 렌더링 | `marked.js` + `highlight.js` (코드 블럭 문법 강조) |
| 파일 정보 | 상단에 파일명, 경로 표시 |
| 스크롤 | 독립 스크롤 영역 |
| 옵시디언 내부 링크 | `[[링크]]` 형태 표시 지원 |

### 3.3 AI 패널 (우측 하단)

#### 3.3.1 AI 엔진 선택
- **Claude CLI** / **Codex CLI** 라디오 버튼으로 선택
- 선택된 엔진에 따라 `claude -p` 또는 `codex exec` 명령 실행

#### 3.3.2 프롬프트 입력
- 기본 템플릿 프롬프트 자동 입력 (수정 가능)
- 기본 프롬프트 예시:
  ```
  다음 마크다운 파일의 내용을 핵심 위주로 요약해 주세요.
  주제, 핵심 내용, 액션 아이템을 구분하여 정리해 주세요.
  출력은 마크다운 형식으로 해 주세요.
  ```

#### 3.3.3 실행 및 결과
- **[▶ 실행]** 버튼: 선택된 MD 파일 내용 + 프롬프트 → AI → 결과 스트리밍 표시
- 결과는 AI 패널 하단 영역에 실시간 렌더링
- 실행 중 로딩 인디케이터 표시

#### 3.3.4 issue 폴더 저장
- **[issue 폴더에 저장]** 버튼 클릭
- AI 실행 결과를 아래 템플릿으로 래핑하여 저장:

```markdown
# {원본파일명} 요약

**원본 파일**: {원본 경로}
**생성일**: {YYYY-MM-DD HH:MM:SS}
**AI 엔진**: {claude | codex}

---

## 요약

{AI 출력 내용}

---

*이 문서는 AI에 의해 자동 생성되었습니다.*
```

- 저장 위치: `{볼트루트}/issue/{원본파일명}_요약_{YYYYMMDD_HHMMSS}.md`
- issue 폴더가 없으면 자동 생성
- 저장 완료 후 폴더 트리 자동 새로고침

### 3.4 파일 업로드

- 헤더 또는 폴더 트리 상단의 **[파일 업로드]** 버튼 클릭
- 팝업 모달 UI:
  - 드래그 앤 드롭 또는 파일 선택 영역
  - **저장 위치 선택**: 폴더 트리 구조로 목적지 선택
  - [업로드] / [취소] 버튼
- 업로드 완료 후 폴더 트리 자동 새로고침

### 3.5 Git 연동

| 버튼 | 동작 |
|------|------|
| **[Git Pull ↓]** | 볼트 경로에서 `git pull origin` 실행 |
| **[Git Push ↑]** | 볼트 경로에서 `git add -A && git commit -m "auto: 웹 뷰어에서 업데이트" && git push origin` 실행 |

- 실행 결과를 팝업 모달에 실시간 출력 (스트리밍)
- 성공/실패 여부 표시

### 3.6 볼트 경로 설정

- 헤더의 **[설정⚙]** 버튼 클릭
- 팝업 모달에서 볼트 경로 입력 및 변경
- 변경 시 폴더 트리 자동 새로고침
- 설정은 서버 측 `data/viewer_config.json`에 저장

---

## 4. API 설계

### 파일 시스템

| Method | Endpoint | 설명 |
|--------|----------|------|
| `GET` | `/api/config` | 현재 볼트 경로 조회 |
| `POST` | `/api/config` | 볼트 경로 설정 |
| `GET` | `/api/tree` | 폴더 트리 JSON 반환 |
| `GET` | `/api/file?path=` | 파일 내용 반환 |
| `POST` | `/api/upload` | 파일 업로드 |

### AI

| Method | Endpoint | 설명 |
|--------|----------|------|
| `POST` | `/api/ai/run` | AI 실행 (스트리밍 SSE) |
| `POST` | `/api/ai/summarize` | 요약 후 issue 폴더 저장 |

### Git

| Method | Endpoint | 설명 |
|--------|----------|------|
| `GET` | `/api/git/status` | Git 상태 조회 |
| `POST` | `/api/git/pull` | Git Pull (스트리밍 SSE) |
| `POST` | `/api/git/push` | Git Push (스트리밍 SSE) |

---

## 5. 파일 구조

```
web/
├── main.py                  # FastAPI 앱 진입점 (port 8101)
├── config.py                # 설정 관리
├── routers/
│   ├── __init__.py
│   ├── files.py             # 파일 시스템 API
│   ├── ai.py                # AI (Claude/Codex) API
│   └── git.py               # Git API
└── static/
    ├── index.html           # 단일 페이지 앱
    ├── style.css            # 스타일
    └── app.js               # 프론트엔드 로직
```

---

## 6. 기술 스택

| 영역 | 기술 |
|------|------|
| 백엔드 | Python 3.11+, FastAPI, uvicorn |
| AI 연동 | Claude CLI (`claude -p`), Codex CLI (`codex exec`) |
| 프론트엔드 | HTML5, CSS3, Vanilla JavaScript |
| MD 렌더링 | marked.js (CDN) |
| 코드 하이라이트 | highlight.js (CDN) |
| 스트리밍 | Server-Sent Events (SSE) |
| 설정 저장 | JSON 파일 (`data/viewer_config.json`) |

---

## 7. 환경변수

| 변수명 | 기본값 | 설명 |
|--------|--------|------|
| `OBSIDIAN_VAULT_PATH` | `~/` | 볼트 루트 경로 |
| `ISSUE_FOLDER` | `issue` | AI 요약 저장 폴더명 |
| `PORT` | `8101` | 서버 포트 |

---

## 8. 보안 고려사항

- 모든 파일 경로는 볼트 루트 내로 제한 (경로 순회 공격 방지)
- 업로드 파일 크기 제한: 50MB
- 허용 파일 확장자: `.md`, `.txt`, `.png`, `.jpg`, `.jpeg`, `.gif`, `.pdf`
- Git 명령은 볼트 경로의 git 저장소에서만 실행

---

## 9. 향후 확장 가능 기능

- 마크다운 파일 인라인 편집
- 옵시디언 `[[내부링크]]` 클릭 네비게이션
- 전체 텍스트 검색 (볼트 내 MD 파일 검색)
- 다크/라이트 테마 전환
- 다중 AI 프롬프트 템플릿 관리
- 파일 이름 변경 / 삭제
